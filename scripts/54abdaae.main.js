window.Tracker=function(){"use strict";function a(){var a=g();document.cookie.indexOf("disableTracking=true")>-1&&this.disableTracking(),"prod"===a?ga("create",f,"auto",{name:"neelabhgProd"}):"angraveprod"===a?(ga("create",c,"auto",{name:"angraveOldProd"}),ga("create",d,"auto",{name:"neelabhgOldProd"})):"staging"===a&&ga("create",e,"auto",{name:"neelabhgStaging"})}var b,c="UA-42515111-2",d="UA-39700861-4",e="UA-39700861-5",f="UA-39700861-6",g=function(){var a=window.location.hostname+window.location.pathname;return"cs-education.github.io/sys/"===a?"prod":"angrave.github.io/sys/"===a?"angraveprod":"cs-education.github.io/sys-staging/"===a?"staging":"dev"};return a.prototype.disableTracking=function(){window["ga-disable-"+c]=!0,window["ga-disable-"+d]=!0,window["ga-disable-"+e]=!0,window["ga-disable-"+f]=!0},a.prototype.isTrackingEnabled=function(){return!(window["ga-disable-"+c]&&window["ga-disable-"+d]&&window["ga-disable-"+e]&&window["ga-disable-"+f])},a.prototype.optout=function(){document.cookie="disableTracking=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/",this.disableTracking()},a.prototype.trackEvent=function(){var a=Array.prototype.slice.call(arguments);a.unshift("event"),ga(function(){ga.getAll().forEach(function(b){b.send.apply(b,a)})})},a.prototype.trackPageView=function(a,b){var c={page:a||window.location.pathname+window.location.search+window.location.hash};b&&(c.title=b),ga(function(){ga.getAll().forEach(function(a){a.send("pageview",c)})})},{getInstance:function(){return b||(b=new a,b.constructor=null),b}}}(),window.SysViewModel=function(){"use strict";function a(){var a=this,b={Waiting:"default",Ready:"success",Compiling:"primary",Cancelled:"default",Success:"success",Warnings:"default-light",Failed:"default-light"},c={Stopped:"danger",Booting:"warning",Running:"success",Paused:"default"},d={life:5e3,theme:"ruby",icon:"exclamation-triangle"},e={life:5e3,theme:"lemon",icon:"info-circled"},f={life:5e3,theme:"lime",icon:"check-mark-2"};a.challengeDoc=ko.observable(""),a.editorText=ko.observable(""),a.gccErrorCount=ko.observable(0),a.gccWarningCount=ko.observable(0),a.gccOptions=ko.observable(""),a.gccOptsError=ko.observable(""),a.programArgs=ko.observable(""),a.lastGccOutput=ko.observable(""),a.compileStatus=ko.observable("Waiting"),a.compileStatusClass=ko.pureComputed(function(){return"label label-"+b[a.compileStatus()]}),a.compileBtnEnable=ko.pureComputed(function(){var b=!("Waiting"===a.compileStatus()||"Compiling"===a.compileStatus());return b?$.notific8("The compiler is now online",f):$.notific8("The compiler is currently busy",e),b}),a.compileBtnTooltip=ko.observable(),a.errorWarningLabel=ko.pureComputed(function(){var b=a.gccErrorCount(),c=a.gccWarningCount(),d="";return d+=b?'<span class="compile-status-label-text-error">'+(b+" error"+(b>1?"s ":""))+(c?"":"…")+"</span>":"",d+=c?'&nbsp;<span class="compile-status-label-text-warning">'+(c+" warning"+(c>1?"s":""))+"…</span>":"",!d&&a.showErrorWarningLabel()&&(d='<span class="compile-status-label-text-error">'+a.compileStatus()+"…</span>"),d}),a.showErrorWarningLabel=ko.pureComputed(function(){var b="Warnings"===a.compileStatus()||"Failed"===a.compileStatus();return b&&$.notific8("There were errors or warnings during compilation",d),b}),a.vmState=ko.observable("Stopped"),a.vmStateClass=ko.pureComputed(function(){return"label label-"+c[a.vmState()]}),a.availableAceThemes=ko.observableArray(["monokai","terminal","tomorrow","xcode"]),a.aceTheme=ko.observable(a.availableAceThemes()[0]),a.aceFontSize=ko.observable(),a.ttyContainer=$("#tty-container"),a.ttyContainerTwo=$("#tty-container-two"),a.currentTTYContainer=a.ttyContainer,a.fullScreenSupported=null!==a.currentTTYContainer.fullScreen(),a.ttyFullScreen=ko.observable(!1),a.toggleFullScreen=function(){a.currentTTYContainer.toggleFullScreen()},a.ttyFullScreen.subscribe(function(){SysRuntime.getInstance().focusTerm(a.isPrimaryTTY()?"tty0":"tty1")}),$(document).bind("fullscreenchange",function(){a.ttyFullScreen(!!a.currentTTYContainer.fullScreen())}),a.isPrimaryTTY=ko.observable(!0),a.isPrimaryTTY.subscribe(function(b){a.currentTTYContainer.hide(),b?(a.currentTTYContainer=a.ttyContainer,SysRuntime.getInstance().focusTerm("tty0")):(a.currentTTYContainer=a.ttyContainerTwo,SysRuntime.getInstance().focusTerm("tty1")),a.currentTTYContainer.show()}),a.ttyToggleBtnClass=ko.pureComputed(function(){return"glyphicon "+(a.ttyFullScreen()?"glyphicon-resize-small":"glyphicon-resize-full")}),a.ttySwitchBtnClass=ko.pureComputed(function(){return"glyphicon "+(a.isPrimaryTTY()?"glyphicon-chevron-right":"glyphicon-chevron-left")}),a.openManPageTabs=ko.observableArray(),a.currentActiveTabIndex=ko.observable(-2),a.closeManPageTab=function(b){var c=a.currentActiveTabIndex(),d=a.openManPageTabs.indexOf(b);a.openManPageTabs.splice(d,1),c>=d&&(c-=1),a.currentActiveTabIndex(c)},a.chapters=ko.observableArray([]),a.currentChapterIdx=ko.observable(0),a.currentChapter=ko.observable(),a.currentSectionIdx=ko.observable(0),a.currentSection=ko.observable(),a.currentActivityIdx=ko.observable(0),a.currentActivity=ko.observable(),a.currentVideoFilePrefix=ko.observable(),a.currentVideoTopics=ko.observable(),a.currentVideoDoc=ko.observable(),a.shownPage=ko.observable(),a.shownPage.subscribe(function(a){"playground"===a?$("body").css("overflow","hidden"):$("body").css("overflow","auto")}),a.getNavUrlPrev=ko.pureComputed(function(){var b=a.currentChapter(),c=parseInt(a.currentSectionIdx(),10),d=parseInt(a.currentActivityIdx(),10),e=b?b.sections[c-1]:null,f=e?e.activities.length:1,g=c,h=d-1;return 0>h&&(g-=1,h=f-1),"#chapter/"+a.currentChapterIdx()+"/section/"+g+"/activity/"+h}),a.getNavUrlNext=ko.pureComputed(function(){var b=a.currentSection(),c=parseInt(a.currentSectionIdx(),10),d=parseInt(a.currentActivityIdx(),10),e=b?b.activities.length:1,f=c,g=d+1;return g>=e&&(f+=1,g=0),"#chapter/"+a.currentChapterIdx()+"/section/"+f+"/activity/"+g}),a.playGroundNavPagerVisible=ko.observable(),a.projectLicense=ko.observable(),$.get("LICENSE.md",function(b){a.projectLicense(marked(b))})}var b;return a.prototype.setSysPlayGroundState=function(a){a=a||{},a.challengeDoc&&this.challengeDoc(a.challengeDoc),a.gccOptions&&this.gccOptions(a.gccOptions),a.programArgs&&this.programArgs(a.programArgs),a.editorText&&this.editorText(a.editorText)},{getInstance:function(){return b||(b=new a,b.constructor=null),b}}}(),window.Preferences=function(){"use strict";function a(){var a=this;try{a.useLocalStorage="undefined"!==localStorage}catch(b){console.log(b),a.useLocalStorage=!1}}function b(a,b){var c=this;c.manager=b,c.prefix="preferences/"+a}var c,d=[];return a.prototype.setItem=function(a,b){if(this.useLocalStorage)try{localStorage.setItem(a,b)}catch(c){console.log(c)}},a.prototype.getItem=function(a,b){if(!this.useLocalStorage)return b;try{var c=localStorage.getItem(a);return null!==c?c:b}catch(d){return console.log(d),b}},a.prototype.removeItem=function(a){if(this.useLocalStorage)try{localStorage.removeItem(a)}catch(b){console.log(b)}},a.prototype.clear=function(){if(this.useLocalStorage)try{localStorage.clear()}catch(a){console.log(a)}},b.prototype.setItem=function(a,b){this.manager.setItem(this.prefix+"/"+a,b)},b.prototype.getItem=function(a,b){return this.manager.getItem(this.prefix+"/"+a,b)},b.prototype.removeItem=function(a){this.manager.removeItem(this.prefix+"/"+a)},{getInstance:function(e){return c||(c=new a,c.constructor=null),d[e]||(d[e]=new b(e,c)),d[e]}}}(),window.ExpectTTY=function(){"use strict";function a(a,b,c,d){this.output="",this.callback=d,this.putCharEventName="putchar-"+b,this.expect=c,this.sys=a,this.found=!1,this.expectPutCharListener=function(a,b){this.output=this.output.substr(this.output.length===this.expect.length?1:0)+b,this.output===this.expect&&(this._cleanup(),this.callback(!0))}.bind(this),this.sys.addListener(this.putCharEventName,this.expectPutCharListener)}return a.prototype._cleanup=function(){this.sys.removeListener(this.putCharEventName,this.expectPutCharListener)},a.prototype.cancel=function(){this._cleanup(),this.callback(!1)},a}(),window.TokenHighlighter=function(){"use strict";function a(a,b,c){var d=this;d.aceEditor=a.aceEditor,d.tokens=b,d.eventCallback=c,d.supportedTypes={identifier:1,"support.function.C99.c":1},d.markers=[],d.tokenStore={},d.busy=!1;var e=null;d.aceEditor.on("change",function(){clearTimeout(e),d.busy||(e=setTimeout(d.highlightTokens.bind(d),500))});var f=function(a){var b=a.getCursorPosition(),c=a.session.getTokenAt(b.row,b.column);a.TokenHighlighter.eventHandler(c)};a.addKeyboardCommand("tokenHighlightShortcut",{win:"Ctrl-I",mac:"Command-I"},f),d.aceEditor.on("click",d.onClick.bind(d))}var b=ace.require("ace/range").Range;return a.prototype.highlightTokens=function(){var a=this;a.busy=!0;var c=a.aceEditor.session,d=c.getLength(),e=a.tokens,f=1,g=0;a.markers.forEach(function(a){c.removeMarker(a)}),a.markers=[];var h=function(d){a.supportedTypes[d.type]&&e.get(d.value,function(e){var h=0;if(e.length&&e[h].name===d.value){for(var i=e[h];i&&2!==i.section&&3!==i.section;)i=e[++h];if(i){a.tokenStore[d.value]=i;var j=new b(f,g,f,g+d.value.length);a.markers.push(c.addMarker(j,"token-highlight","text"))}}}),g+=d.value.length};for(f=1;d>=f;f++){var i=c.getTokens(f);g=0,i.forEach(h)}a.busy=!1},a.prototype.onClick=function(a){var b=a.editor,c=b.renderer,d=c.rect||(c.rect=c.scroller.getBoundingClientRect()),e=(a.clientX+c.scrollLeft-d.left-c.$padding)/c.characterWidth,f=Math.floor((a.clientY+c.scrollTop-d.top)/c.lineHeight),g=Math.round(e),h={row:f,column:g,side:e-g>0?1:-1},i=b.session.getTokenAt(h.row,h.column);i&&this.supportedTypes[i.type]&&this.eventHandler(i)},a.prototype.eventHandler=function(a){this.tokenStore[a.value]&&this.eventCallback(this.tokenStore[a.value])},a.prototype.destroy=function(){delete this.aceEditor.TokenHighlighter},a}(),window.Editor=function(){"use strict";function a(a){var c=this;c.editorId=b,b+=1,c.viewModel=SysViewModel.getInstance(),c.editorDivId=a,c.aceEditor=ace.edit(a),c.aceEditor.$blockScrolling=1/0,c.setMode("c_cpp"),c.aceEditor.getSession().setTabSize(4),c.aceEditor.getSession().setUseSoftTabs(!0),c.preferences=Preferences.getInstance("editor");var d=c.preferences.getItem("autoindent","true"),e=c.preferences.getItem("highlightline","true"),f=c.preferences.getItem("showinvisibles","false"),g=c.preferences.getItem("theme",c.viewModel.aceTheme()),h=c.preferences.getItem("fontsize",12);c.backgroundAutoIndent="true"===d,c.aceEditor.setHighlightActiveLine("true"===e),c.aceEditor.setShowInvisibles("true"===f),c.setTheme(g),c.viewModel.aceTheme(g),c.setFontSize(h+"px"),c.viewModel.aceFontSize(h),c.viewModel.aceTheme.subscribe(function(a){c.setTheme(a),c.preferences.setItem("theme",a)}),c.viewModel.aceFontSize.subscribe(function(a){c.setFontSize(a+"px"),c.preferences.setItem("fontsize",a)}),c.viewModel.editorText.subscribe(function(a){c.setText(a)}),c.aceEditor.on("change",function(){c.backgroundAutoIndent&&(window.clearTimeout(c.reIndentTimer),c.reIndenting||(c.reIndentTimer=window.setTimeout(c.autoIndentCode.bind(c),500)))}),c.elementIdPrefix="editor"+c.editorId+"-";var i=$("<div>").append($("<form>").append($("<div>").attr("class","checkbox").append($("<label>").append($("<input>").attr({id:c.elementIdPrefix+"autoindent-checkbox",type:"checkbox"})).append($("<span>").text("Autoindent code")))).append($("<div>").attr("class","checkbox").append($("<label>").append($("<input>").attr({id:c.elementIdPrefix+"ace-highlight-active-lines-checkbox",type:"checkbox"})).append($("<span>").text("Highlight Active Line")))).append($("<div>").attr("class","checkbox").append($("<label>").append($("<input>").attr({id:c.elementIdPrefix+"ace-show-invisibles-checkbox",type:"checkbox"})).append($("<span>").text("Show invisible characters"))))),j=$("#editor-settings-btn");j.popover({title:function(){return"Editor settings"},content:function(){return i.html()}}),j.on("shown.bs.popover",function(){$("#"+c.elementIdPrefix+"autoindent-checkbox").prop("checked",c.backgroundAutoIndent),$("#"+c.elementIdPrefix+"ace-highlight-active-lines-checkbox").prop("checked",c.aceEditor.getHighlightActiveLine()),$("#"+c.elementIdPrefix+"ace-show-invisibles-checkbox").prop("checked",c.aceEditor.getShowInvisibles())});var k=$("body");k.on("change","#"+c.elementIdPrefix+"autoindent-checkbox",function(){c.backgroundAutoIndent=this.checked,c.preferences.setItem("autoindent",this.checked)}),k.on("change","#"+c.elementIdPrefix+"ace-highlight-active-lines-checkbox",function(){c.aceEditor.setHighlightActiveLine(this.checked),c.preferences.setItem("highlightline",this.checked)}),k.on("change","#"+c.elementIdPrefix+"ace-show-invisibles-checkbox",function(){c.aceEditor.setShowInvisibles(this.checked),c.preferences.setItem("showinvisibles",this.checked)}),k.on("click",function(){j.popover("hide")}),k.on("click",".popover",function(a){a.stopPropagation()}),j.on("click",function(a){j.popover("toggle"),a.stopPropagation()})}var b=0;return a.prototype.setTheme=function(a){this.aceEditor.setTheme("ace/theme/"+a)},a.prototype.getText=function(){return this.aceEditor.getSession().getValue()},a.prototype.setText=function(a){return this.aceEditor.getSession().setValue(a)},a.prototype.setFontSize=function(a){document.getElementById(this.editorDivId).style.fontSize=a},a.prototype.setMode=function(a){this.aceEditor.getSession().setMode("ace/mode/"+a)},a.prototype.setAnnotations=function(a){this.aceEditor.getSession().setAnnotations(a)},a.prototype.setTokenHighlighter=function(a,b){this.tokenHighlighter=new TokenHighlighter(this,a,b)},a.prototype.resize=function(a){var b=this;a=a||200,window.setTimeout(function(){$("#"+b.editorDivId).height($("#code-container").height()-$("#editor-tabs-bar").height()-$("#editor-opts-container").height()-$("#compile-opts-container").height()-2),b.aceEditor.resize()},a)},a.prototype.addKeyboardCommand=function(a,b,c,d){d="undefined"==typeof d?!0:!!d,this.aceEditor.commands.addCommand({name:a,bindKey:b,exec:c,readOnly:d})},a.prototype.autoIndentCode=function(){var a,b,c,d,e=this.aceEditor,f=e.getCursorPosition(),g=e.getSession(),h=g.getDocument(),i=g.getMode(),j=g.getLength();for(this.reIndenting=!0,a=0;j>a;a++)0!==a&&(b=i.getNextLineIndent(g.getState(a-1),g.getLine(a-1),g.getTabString()),c=g.getLine(a),d=/^\s*/.exec(c)[0],d!==b&&(c=b+c.trim()),h.insertFullLines(a,[c]),h.removeFullLines(a+1,a+1),i.autoOutdent(g.getState(a),g,a));e.moveCursorToPosition(f),e.clearSelection(),this.reIndenting=!1},a}(),window.GccOutputParser=function(){"use strict";function a(){}var b=/(.+?):\s*(.+)\s*:\s*(.+)\s*/,c=/(\d+):(\d+):\s*(.+)/,d=/\s*(.+)\s*:\s*(.+)\s*/,e={"program.c":"compile",gcc:"gcc",cc1:"gcc",collect2:"linker"};return a.prototype.parse=function(a){var f,g,h,i,j,k,l,m=[];return a.split("\n").forEach(function(a){f=b.exec(a),f&&(g=c.exec(f[2]),g?(i=g[1],j=g[2],h=d.exec(g[3]),h?(k=h[1],l=h[2]+": "+f[3]):(k=g[3],l=f[3])):(i=j=0,h=d.exec(f[2]),h?(k=h[1],l=h[2]+": "+f[3]):(k=f[2],l=f[3])),m.push({row:i,column:j,type:e[f[1]],gccErrorType:k,text:l}))}),m},a}(),window.LiveEdit=function(){"use strict";function a(a,b){this.runtime=b,this.editor=a,this.viewModel=SysViewModel.getInstance();var c=function(){var a=this.runtime.ready();this.viewModel.vmState(a?"Running":"Booting"),this.viewModel.compileStatus(a?"Ready":"Waiting")}.bind(this);c(),this.runtime.addListener("ready",function(){c()}.bind(this))}return a.prototype.escapeHtml=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},a.prototype.processGccCompletion=function(a){if(this.viewModel.gccErrorCount(0),this.viewModel.gccWarningCount(0),!a)return void this.viewModel.compileStatus("Cancelled");this.runtime.sendKeys("tty0","clear\n");var b=[],c=[];a.annotations.forEach(function(a){a.isGccOptsError?c.push(a):b.push(a)}),this.editor.setAnnotations(b),this.viewModel.lastGccOutput(a.gccOutput),this.viewModel.gccErrorCount(a.stats.error),this.viewModel.gccWarningCount(a.stats.warning),this.viewModel.gccOptsError(c.map(function(a){return a.text}).join("\n")),0===a.exitCode?(this.viewModel.compileStatus(a.stats.warning>0?"Warnings":"Success"),this.runtime.startProgram("program",this.viewModel.programArgs())):this.viewModel.compileStatus("Failed")},a.prototype.runCode=function(a,b){if(!(0===a.length||a.indexOf("")>=0||a.indexOf("")>=0)){var c=this.processGccCompletion.bind(this);this.viewModel.compileStatus("Compiling"),this.runtime.startGccCompile(a,b,c)}},a}(),window.SysRuntime=function(){"use strict";function a(){this.bootFinished=!1,this.tty0ready=!1,this.tty1ready=!1,this.listeners={},this.ttyOutput="",this.captureOutput=!1,this.compileTicket=0,this.gccOutputCaptureRe=/###GCC_COMPILE###\s*([\S\s]*?)\s*###GCC_COMPILE_FINISHED###/,this.gccExitCodeCaptureRe=/GCC_EXIT_CODE: (\d+)/,this.putCharTTY0Listener=function(a){this.captureOutput&&(this.ttyOutput+=a),this.notifyListeners("putchar-tty0",a)}.bind(this),this.putCharTTY1Listener=function(a){this.notifyListeners("putchar-tty1",a)}.bind(this);var a=function(){this.tty0ready&&this.tty1ready&&(this.bootFinished=!0,this.notifyListeners("ready",!0))}.bind(this),b=function(b){this.tty0ready=b,a()}.bind(this),c=function(b){this.tty1ready=b,a()}.bind(this),d=function(a){a&&this.sendKeys("tty1","login -f user\n","~ $",c)}.bind(this),e=function(a){a&&this.sendKeys("tty0","stty -clocal crtscts -ixoff\necho boot2ready-$?\n","boot2ready-0",b)}.bind(this),f=function(a){a&&this.sendKeys("tty1","stty -clocal crtscts -ixoff\necho boot2ready-$?\n","boot2ready-0",d)}.bind(this),g=require("MackeTerm"),h=require("Jor1k"),i=new g("tty0"),j=new g("tty1"),k={system:{kernelURL:"vmlinux.bin.bz2",memorysize:32,cpu:"asm",ncores:1},fs:{basefsURL:"basefs-compile.json",extendedfsURL:"https://cs-education.github.io/sysassets/jor1kfs/sysroot/fs.json",earlyload:["usr/bin/gcc","usr/libexec/gcc/or1k-linux-musl/4.9.0/cc1","usr/libexec/gcc/or1k-linux-musl/4.9.0/collect2","usr/lib/libbfd-2.24.51.20140817.so","usr/lib/gcc/or1k-linux-musl/4.9.0/libgcc.a","usr/bin/as","usr/include/stdio.h"],lazyloadimages:[]},terms:[i,j],statsid:"vm-stats",memorysize:32,path:"../jor1k/bin/"};return this.jor1kgui=new h(k),i.SetCharReceiveListener(this.putCharTTY0Listener),j.SetCharReceiveListener(this.putCharTTY1Listener),this.sendKeys("tty0","","~ $",e),this.sendKeys("tty1","","~ #",f),this}a.prototype.ready=function(){return this.bootFinished},a.prototype.focusTerm=function(a){this.jor1kgui.FocusTerm(a)},a.prototype.startGccCompile=function(a,b,c){if(!this.bootFinished)return 0;this.expecting&&this.expecting.cancel(),this.ttyOutput="",this.captureOutput=!0,++this.compileTicket;var d=function(a){var b=null;if(this.expecting=void 0,a){this.captureOutput=!1;var d=this.gccOutputCaptureRe.exec(this.ttyOutput),e=d[1],f=parseInt(this.gccExitCodeCaptureRe.exec(e)[1]);this.ttyOutput="";var g={error:0,warning:0,info:0},h=this.getErrorAnnotations(e);h.forEach(function(a){g[a.type]+=1}),b={exitCode:f,stats:g,annotations:h,gccOutput:e}}c(b)}.bind(this);this.sendKeys("tty0","\ncd ~;rm program.c program 2>/dev/null\n"),this.sendTextFile("program.c",a);var e="echo \\#\\#\\#GCC_COMPILE\\#\\#\\#;clear;gcc "+b+" program.c -o program; echo GCC_EXIT_CODE: $?; echo \\#\\#\\#GCC_COMPILE_FINISHED\\#\\#\\#"+this.compileTicket+".;clear\n";return this.expecting=this.sendKeys("tty0",e,"GCC_COMPILE_FINISHED###"+this.compileTicket+".",d),this.compileTicket},a.prototype.getErrorAnnotations=function(a){var b=(new GccOutputParser).parse(a);return b.map(function(a){var b;return b=-1!==a.gccErrorType.toLowerCase().indexOf("error")?"error":-1!==a.gccErrorType.toLowerCase().indexOf("warning")?"warning":"info","undefined"==typeof a.type&&(a.row=a.col=-1),{row:a.row-1,col:a.col,isGccOptsError:"gcc"===a.type,type:b,text:a.text}})},a.prototype.startProgram=function(a,b){a&&("/"!==a[0]&&"."!==a[0]&&(a="./"+a.replace(" ","\\ ")),b=b.replace("\\","\\\\").replace("\n","\\n"),this.sendKeys("tty0","\n"+a+" "+b+"\n"))},a.prototype.sendTextFile=function(a,b){this.sendKeys("tty0","\nstty raw\ndd ibs=1 of="+a+" count="+b.length+"\n"+b+"\nstty -raw\n")},a.prototype.addListener=function(a,b){var c=this.listeners[a];c?c.push(b):this.listeners[a]=[b]},a.prototype.removeListener=function(a,b){var c=this.listeners[a];this.listeners[a]=c.filter(function(a){return a!==b})},a.prototype.notifyListeners=function(a,b){var c=this.listeners[a];if(c){c=c.slice();for(var d=0;c&&d<c.length;d++)c[d](this,b)}},a.prototype.sendKeys=function(a,b,c,d,e){var f=null,g=b.split("").map(function(a){return a.charCodeAt(0)>>>0});return this.jor1kgui.Pause(!1),c&&(f=new ExpectTTY(this,a,c,d,e)),this.jor1kgui.message.Send(a,g),f};var b;return{getInstance:function(){return b||(b=new a,b.constructor=null),b}}}(),window.videoPlayerConfig=function(){"use strict";function a(a,b,c){a.src([{type:"video/mp4",src:b+".mp4"},{type:"video/webm",src:b+".webm"},{type:"video/ogg",src:b+".ogv"}]),a.on("loadstart",function(){var b="English";a.addRemoteTextTrack({kind:"captions",language:"en",label:b,src:"https://cs-education.github.io/sysassets/transcriptions/"+c+".webvtt"}),$("div.video-js > div.vjs-control-bar > div.vjs-captions-button > div.vjs-control-content > div.vjs-menu > ul.vjs-menu-content > li.vjs-menu-item").each(function(a,c){c.innerHTML===b&&c.click()})})}return{configure:a}}(),window.Router=function(){"use strict";function a(){var a=SysViewModel.getInstance(),b=function(){var b=!1;return function(){var c;return c=b?{done:function(){return this},fail:function(a){return a&&a(),this}}:0===a.chapters().length?$.getJSON("https://cs-education.github.io/sysassets/sys.min.json",function(b){a.chapters(b.chapters)}).fail(function(){b=!0}):{done:function(a){return a&&a(),this},fail:function(){return this}}}}(),c=function(b,c,d){var e=a.chapters()[b];e=e||{sections:[]};var f=e.sections[c];f=f||{activities:[]};var g=f.activities[d];g=g||{},a.currentChapterIdx(b),a.currentChapter(e),a.currentSectionIdx(c),a.currentSection(f),a.currentActivityIdx(d),a.currentActivity(g)},d=function(){$("#lesson-video").length>0&&videojs("lesson-video").dispose()},e=function(b){d();var c=function(c){a.setSysPlayGroundState({challengeDoc:marked(c),gccOptions:b.gccOptions||"",programArgs:b.programCommandLineArgs||"",editorText:b.code||""}),a.currentActiveTabIndex(-2),a.openManPageTabs([]),a.shownPage("playground"),a.playGroundNavPagerVisible(!0),Tracker.getInstance().trackPageView()};b.docFile?$.get("https://cs-education.github.io/sysassets/"+b.docFile).done(c).fail(function(){c(b.doc||"")}):c(b.doc||"")},f=function(b){var c=function(c){a.shownPage("video"),Tracker.getInstance().trackPageView();var e="https://cs-education.github.io/sysassets/"+b.file;a.currentVideoFilePrefix(e),a.currentVideoTopics(b.topics||""),a.currentVideoDoc(marked(c));var f=$("<video>").attr("id","lesson-video").addClass("video-js vjs-default-skin vjs-big-play-centered");d(),$("#lesson-video-container").width(960).append(f),videojs("lesson-video",{controls:!0,preload:"none",width:960,height:540,poster:""},function(){var a=b.file.replace("mp4/","");videoPlayerConfig.configure(this,e,a)})};b.docFile?$.get("https://cs-education.github.io/sysassets/"+b.docFile).done(c).fail(function(){c(b.doc||"")}):c(b.doc||"")};return Sammy(function(){this.get("/",function(){var c=this;window.location.hash="",b().done(function(){d(),a.currentChapterIdx(0),a.currentChapter(null),a.currentSectionIdx(0),a.currentSection(null),a.currentActivityIdx(0),a.currentActivity(null),a.shownPage("chapter_index"),Tracker.getInstance().trackPageView()}).fail(function(){c.redirect("#playground")})}),this.get("#chapter/:chapterIdx",function(){this.redirect("#chapter/"+this.params.chapterIdx+"/section/0/activity/0")}),this.get("#chapter/:chapterIdx/section/:sectionIdx",function(){this.redirect("#chapter/"+this.params.chapterIdx+"/section/"+this.params.sectionIdx+"/activity/0")}),this.get("#chapter/:chapterIdx/section/:sectionIdx/activity/:activityIdx",function(){var d=this;b().done(function(){c(d.params.chapterIdx,d.params.sectionIdx,d.params.activityIdx);var b=a.currentActivity();"play"===b.type?e(b):"video"===b.type?f(b):d.redirect("#/")}).fail(function(){d.redirect("#playground")})}),this.get("#playground",function(){b();var c={};c.doc="# Welcome\nWelcome to this tiny but fast linux virtual machine. Write C code on the left and press the run button, or simply have fun with the linux command line below! Some things to try:\n* Play battleship (type `bs` then enter), Solitaire (type `blue` then enter) or the famous Tower of Hanoi game (type `hanoi` then enter) in the terminal\n* Destroy the system! Type `su`, press enter then type `rm -rf /` and watch the chaos! (Don't worry, it's safe. Simply refresh the page to start over)\n\nOnce you are done playing, learn C and system programming! Go to the lessons page by clicking the link in the top navigation bar.",c.gccOptions="-lm -Wall -fmax-errors=10 -Wextra",c.programCommandLineArgs="",c.code='/*Write your C code here*/\n#include <stdio.h>\n\nint main() {\n    printf("Hello world!\\n");\n    return 0;\n}\n',e(c),a.playGroundNavPagerVisible(!1)})})}var b;return{getInstance:function(){return b||(b=new a,b.constructor=null),b}}}(),$(document).ready(function(){"use strict";var a=function(){var a=$("#layout").layout({livePaneResizing:!0,north__paneSelector:"#navbar-container",center__paneSelector:"#code-container",east__paneSelector:"#doc-tty-container",south__paneSelector:"#footer-container",east__size:"50%",spacing_open:2,north__resizable:!1,north__size:33,north__spacing_open:0,north__spacing_closed:0,north__showOverflowOnHover:!0,south__resizable:!1,south__size:29,south__spacing_open:0,onresizeall:function(a,b){var c=b.container.outerWidth;800>=c&&!b.east.isClosed?(a.close("east"),b.east.autoClosed=!0):b.east.autoClosed&&(a.open("east"),b.east.autoClosed=!1)}}),b=a.panes.east.layout({livePaneResizing:!0,spacing_open:2,north__paneSelector:"#doc-container",center__paneSelector:"#tty-pane",north__size:"40%"});return{mainLayout:a,ttyLayout:b}},b=SysViewModel.getInstance(),c=new Editor("code"),d=new LiveEdit(c,SysRuntime.getInstance()),e=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("name","summary"),queryTokenizer:Bloodhound.tokenizers.whitespace,limit:10,prefetch:{url:"https://cs-education.github.io/sysassets/man_pages/sys_man_page_index.min.json"}});e.initialize();var f=null,g=function(a){var b=a.name,c=a.section,d="https://cs-education.github.io/sysassets/man_pages/html/man"+c+"/"+b+"."+c+".html";return{tabName:b+" ("+c+")",tabHtml:'<iframe style="width: 100%; height: 100%" src="'+d+'"></iframe>'}},h=function(a){var c;a&&(c=b.openManPageTabs,c.push(g(a)),b.currentActiveTabIndex(c().length-1))},i=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("name"),queryTokenizer:Bloodhound.tokenizers.whitespace,limit:10,prefetch:{url:"https://cs-education.github.io/sysassets/man_pages/sys_man_page_index.min.json"}});i.initialize(),c.setTokenHighlighter(i,h),$("#man-pages-search-typeahead").children(".typeahead").typeahead({highlight:!0},{displayKey:"name",source:e.ttAdapter(),templates:{empty:['<div class="empty-message">',"unable to find any man pages that match the current query","</div>"].join("\n"),suggestion:function(a){return["<div>","<p><strong>"+a.name+'</strong><span class="pull-right"> Section '+a.section+"</span></p>","<p>"+a.summary+"</p>","</div>"].join("\n")}}}).on("typeahead:selected typeahead:autocompleted",function(a,b){f=b}).keypress(function(a){13===a.which?h(f):f=null}).keydown(function(a){8===a.which&&(f=null)}),$("#man-page-open-btn").click(function(){h(f)});var j=function(){window.setTimeout(function(){$(".tab-content").height($("#code-container").height()-$("#editor-tabs-bar").height()-5)},500)};$(window).resize(function(){c.resize(500),j()}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(a){"#editor-container"===$(a.target).attr("href")?c.resize():j()});var k={win:"Ctrl-Return",mac:"Command-Return"},l=(navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase(),m="Compile and Run ("+("mac"===l?k.mac.replace("Command","⌘"):k.win)+" in code editor)";b.compileBtnTooltip(m);var n=function(){var a=c.getText(),e=b.gccOptions();d.runCode(a,e)};$("#compile-btn").click(function(){n()}),c.addKeyboardCommand("compileAndRunShortcut",k,n,!0),$("[data-toggle=tooltip]").tooltip(),$("[data-toggle=popover]").popover().click(function(a){a.preventDefault()}),$("#editor-opts-container").find("form").submit(function(a){a.preventDefault(),a.stopPropagation()}),$("#download-file-btn").click(function(){var a=c.getText(),b=new Blob([a],{type:"text/plain;charset=utf-8"});saveAs(b,"program.c")}),$("#autoindent-code-btn").click(function(){c.autoIndentCode()}),ko.applyBindings(b),b.shownPage.subscribe(function(b){"playground"===b&&(window.layouts||(window.layouts=a()),$(window).trigger("resize"))}),Router.getInstance().run();var o=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("title","snippet"),queryTokenizer:Bloodhound.tokenizers.whitespace,limit:10,prefetch:{url:"https://cs-education.github.io/sysassets/transcriptions/transcription_index.min.json"}});o.initialize();var p=function(){$("#search-video").length>0&&videojs("search-video").dispose()},q=function(a){var b=$("<video>").attr("id","search-video").addClass("video-js vjs-default-skin vjs-big-play-centered");p(),$("#search-video-container").width(640).append(b);var c=videojs("search-video",{controls:!0,preload:"none",width:640,height:264,poster:""},function(){var b="https://cs-education.github.io/sysassets/mp4/"+a.source;videoPlayerConfig.configure(this,b,a.source)});c.currentTime(a.startTime),c.play()},r=null;$("#video-search-typeahead").children(".typeahead").typeahead({highlight:!0},{displayKey:"title",source:o.ttAdapter(),templates:{empty:['<div class="empty-message">',"unable to find any video lessons that match the current query","</div>"].join("\n"),suggestion:function(a){return["<div>","<p><strong>"+a.title+'</strong><span class="pull-right"> Time '+a.startTime+"</span></p>","<p>"+a.snippet+"</p>","</div>"].join("\n")}}}).on("typeahead:selected typeahead:autocompleted",function(a,b){r=b}).keypress(function(a){13===a.which?q(r):r=null}).keydown(function(a){8===a.which&&(r=null)}),$("#video-search-btn").click(function(){q(r)})});